<%- include('partials/header') %>

<main id="main">

<h2>Send Certified Mail</h2>
<p class="subtitle">No account needed. Just fill out the form, pay, and we print, certify, and mail it through USPS.</p>

<div class="trust-strip">
  <span class="trust-strip-item">
    <svg class="icon" aria-hidden="true"><use href="#icon-lock"/></svg>
    Encrypted &amp; Secure
  </span>
  <span class="trust-strip-sep" aria-hidden="true">&middot;</span>
  <span class="trust-strip-item">
    <svg class="icon" aria-hidden="true"><use href="#icon-shield"/></svg>
    Your data is protected
  </span>
  <span class="trust-strip-sep" aria-hidden="true">&middot;</span>
  <span class="trust-strip-item">
    <svg class="icon" aria-hidden="true"><use href="#icon-envelope-check"/></svg>
    Official USPS Certified Mail
  </span>
</div>

<div class="no-signup-stamp">No Signup Required</div>

<% if (typeof error !== 'undefined' && error) { %>
  <div class="msg error" role="alert"><%= error %></div>
<% } %>

<form action="/checkout" method="POST" enctype="multipart/form-data">
  <input type="hidden" name="_csrf" value="<%= csrfToken %>">

  <fieldset class="form-section">
    <legend class="section-label">Sender</legend>
    <span class="encrypted-label"><svg class="icon" aria-hidden="true"><use href="#icon-lock"/></svg> Encrypted</span>

    <label for="sender_name">Full Name</label>
    <input type="text" id="sender_name" name="sender_name" autocomplete="name" required>

    <label for="sender_street">Street Address</label>
    <input type="text" id="sender_street" name="sender_street" autocomplete="address-line1" required>

    <div class="row">
      <div>
        <label for="sender_city">City</label>
        <input type="text" id="sender_city" name="sender_city" autocomplete="address-level2" required>
      </div>
      <div>
        <label for="sender_state">State</label>
        <input type="text" id="sender_state" name="sender_state" autocomplete="address-level1" maxlength="2" required>
      </div>
      <div>
        <label for="sender_zip">ZIP</label>
        <input type="text" id="sender_zip" name="sender_zip" autocomplete="postal-code" maxlength="10" required>
      </div>
    </div>

    <label for="customer_email">Your Email (for tracking info)</label>
    <input type="email" id="customer_email" name="customer_email" autocomplete="email" required>
  </fieldset>

  <fieldset class="form-section">
    <legend class="section-label">Recipient</legend>
    <span class="encrypted-label"><svg class="icon" aria-hidden="true"><use href="#icon-lock"/></svg> Encrypted</span>

    <label for="recipient_name">Full Name</label>
    <input type="text" id="recipient_name" name="recipient_name" required>

    <label for="recipient_street">Street Address</label>
    <input type="text" id="recipient_street" name="recipient_street" required>

    <div class="row">
      <div>
        <label for="recipient_city">City</label>
        <input type="text" id="recipient_city" name="recipient_city" required>
      </div>
      <div>
        <label for="recipient_state">State</label>
        <input type="text" id="recipient_state" name="recipient_state" maxlength="2" required>
      </div>
      <div>
        <label for="recipient_zip">ZIP</label>
        <input type="text" id="recipient_zip" name="recipient_zip" maxlength="10" required>
      </div>
    </div>
  </fieldset>

  <fieldset class="form-section">
    <legend class="section-label">Letter Content</legend>
    <span class="encrypted-label"><svg class="icon" aria-hidden="true"><use href="#icon-lock"/></svg> Encrypted</span>

    <div class="radio-group">
      <div>
        <input type="radio" id="mode_text" name="letter_mode" value="text" checked onchange="toggleMode()">
        <label for="mode_text">Type / paste text</label>
      </div>
      <div>
        <input type="radio" id="mode_pdf" name="letter_mode" value="pdf" onchange="toggleMode()">
        <label for="mode_pdf">Upload PDF</label>
      </div>
    </div>

    <div id="text_input">
      <label for="letter_text">Letter Text</label>
      <textarea id="letter_text" name="letter_text" placeholder="Type or paste your letter here..."></textarea>
    </div>

    <div id="pdf_input" style="display:none">
      <label for="letter_pdf">Upload PDF</label>
      <input type="file" id="letter_pdf" name="letter_pdf" accept="application/pdf">
    </div>
  </fieldset>

  <fieldset class="form-section">
    <legend class="section-label">Options</legend>

    <div class="checkbox-row">
      <input type="checkbox" id="return_receipt" name="return_receipt" value="1" onchange="updatePrice()">
      <label for="return_receipt">Add Electronic Return Receipt (+$3.00)</label>
    </div>

    <div class="price-box" id="price_display" aria-live="polite">Total: $10.00</div>
  </fieldset>

  <div class="active-security-msg">
    <svg class="icon" aria-hidden="true"><use href="#icon-shield"/></svg>
    Your connection is encrypted. Your data is protected.
  </div>

  <div class="secure-checkout-box">
    <h3>
      <svg class="icon" aria-hidden="true"><use href="#icon-shield"/></svg>
      Secure Checkout
    </h3>
    <p>Your payment is processed by Stripe. We never store or see your credit card information.</p>
    <span class="stripe-badge">
      <svg class="icon" aria-hidden="true"><use href="#icon-stripe"/></svg>
      Powered by Stripe
    </span>
  </div>

  <div style="margin-top:.5rem">
    <span class="usps-badge">
      <svg class="icon" aria-hidden="true"><use href="#icon-eagle"/></svg>
      Ships via United States Postal Service
    </span>
  </div>

  <button type="submit">Pay &amp; Send Certified Mail</button>

</form>

<script>
function toggleMode(){
  var t=document.getElementById('mode_text').checked;
  document.getElementById('text_input').style.display=t?'':'none';
  document.getElementById('pdf_input').style.display=t?'none':'';
}
function updatePrice(){
  var rr=document.getElementById('return_receipt').checked;
  document.getElementById('price_display').textContent=rr?'Total: $13.00':'Total: $10.00';
}
</script>

<%- include('partials/footer') %>
